# 图形验证码

需要使用图形验证码的接口新增必填字段：captcha，如果没传则中断接口执行：“非法请求”。

## /captcha/generate 获取图形验证码

方法：POST

```javascript
{
  account: "lGOqfRXJvMJjpMOXjQP/tA=="; // 账号
}
```

## /captcha/validate 校验图形验证码

方法：POST

```javascript
{
  account: "lGOqfRXJvMJjpMOXjQP/tA=="; // 账号
  accountType: 0; // 账号类型
  graphCaptcha: "cb88w"; // 图形码
  purpose: 3; // 用途
  zhflag: 1; // 国际化，暂时不需要
}
```

## 执行流程

以短信验证码 /code 接口举例，流程如下：

1. 前端输入手机号，点击获取验证码，携带手机号向 /code 发送 POST 请求。
2. 后端生成图形验证码，并通过 ID 保存到 cache 中，然后返回给前端。
3. 前端收到图形验证码，新增弹窗交互，并显示图形验证码。
4. 用户输入并确认，向 /captcha/validate 发起校验请求。
5. 后端通过 ID 从 cache 里取出值，与前端传来的值作比较。
   1. 校验通过，发送短信验证码，返回结果给前端。前端关闭弹窗。
   2. 校验不通过，返回结果（图形验证码错误）给前端。前端不关闭弹窗。
